import streamlit as st
import yfinance as yf
import pandas as pd
import plotly.graph_objects as go

# ===============================
# ูุงุฌูุฉ ุงูุชุทุจูู
# ===============================
st.set_page_config(page_title="ุชุญููู ุจูุงูุงุช ุงูุฃุณูู", layout="centered")

st.title("๐ ุชุทุจูู ุชุญููู ุจูุงูุงุช ุงูุฃุณูู")
st.markdown("ุงุฎุชุฑ ุงูุฏููุฉ ูุงูุณูู ูุนุฑุถ ุจูุงูุงุชู ุงูุชุงุฑูุฎูุฉ.")

# ===============================
# ุงุฎุชูุงุฑ ุงูุฏููุฉ
# ===============================
countries = {
    "ุงูููุงูุงุช ุงููุชุญุฏุฉ ๐บ๐ธ": "US",
    "ูุฑูุณุง ๐ซ๐ท": "FR",
    "ุฃููุงููุง ๐ฉ๐ช": "DE",
    "ุงูููููุฉ ุงููุชุญุฏุฉ ๐ฌ๐ง": "UK",
    "ุงููุงุจุงู ๐ฏ๐ต": "JP",
    "ููุฏุง ๐จ๐ฆ": "CA",
    "ุงูููุฏ ๐ฎ๐ณ": "IN",
    "ุชููุณ ๐น๐ณ": "TN"
}

country_name = st.selectbox("ุงุฎุชุฑ ุงูุฏููุฉ:", list(countries.keys()))
country_code = countries[country_name]

# ===============================
# ุงุฎุชูุงุฑ ุงูุณูู
# ===============================
st.write("โณ๏ธ ุฃุฏุฎู ุฑูุฒ ุงูุณูู (Ticker):")
st.markdown("- ูู ุฃูุฑููุง ูุซููุง: `AAPL` (Apple) ุฃู `MSFT` (Microsoft)")
st.markdown("- ูู ูุฑูุณุง: `AIR.PA` (Airbus)")
st.markdown("- ูู ุฃููุงููุง: `BMW.DE` (BMW)")
st.markdown("- ูู ุชููุณ ุฃู ุงูุฏูู ุบูุฑ ุงููุฏุนููุฉ ูู Yahoo ูุฏ ูุง ุชุชููุฑ ุงูุจูุงูุงุช")

stock_symbol = st.text_input("ุฑูุฒ ุงูุณูู", "AAPL")

# ===============================
# ุงุฎุชูุงุฑ ุงููุชุฑุฉ ุงูุฒูููุฉ
# ===============================
period = st.selectbox("ุงููุชุฑุฉ ุงูุฒูููุฉ:", ["1mo", "3mo", "6mo", "1y", "2y", "5y", "10y"])

# ===============================
# ุนูุฏ ุงูุถุบุท ุนูู ุงูุฒุฑ
# ===============================
if st.button("ุชุญููู ุงูุจูุงูุงุช"):
    try:
        data = yf.download(stock_symbol, period=period)

        if data.empty:
            st.error("โ๏ธ ูู ูุชู ุงูุนุซูุฑ ุนูู ุจูุงูุงุช ููุฐุง ุงูุณูู. ุชุฃูุฏ ูู ุงูุฑูุฒ ูุงูุฏููุฉ.")
        else:
            st.success("โ ุชู ุชุญููู ุงูุจูุงูุงุช ุจูุฌุงุญ!")

            # ุนุฑุถ ุงูุจูุงูุงุช ูู ุฌุฏูู
            st.dataframe(data.tail(10))

            # ===============================
            # ุฑุณู ุจูุงูู ุจุงูุดููุน ุงููุงุจุงููุฉ
            # ===============================
            fig = go.Figure(
                data=[
                    go.Candlestick(
                        x=data.index,
                        open=data['Open'],
                        high=data['High'],
                        low=data['Low'],
                        close=data['Close']
                    )
                ]
            )

            fig.update_layout(
                title=f"ุฑุณู ุจูุงูู ูุณูู {stock_symbol}",
                xaxis_title="ุงูุชุงุฑูุฎ",
                yaxis_title="ุงูุณุนุฑ",
                xaxis_rangeslider_visible=False
            )

            st.plotly_chart(fig, use_container_width=True)

    except Exception as e:
        st.error(f"ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญููู ุงูุจูุงูุงุช: {e}")



